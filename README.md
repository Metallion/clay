# Summary

Clay is an abstract system model store to automate something.
It provides some APIs to access the system model store.

# How to use

```
$ go build
$ ./clay
```

server runs at http://localhost:8080, unless set HOST and PORT environmental variables.

# Example model

```
$ curl -X PUT localhost:8080/v1/designs/present -H "Content-Type: application/json" -d @examples/design.json
```

# Example template

```
$ # register template and external parameters
$ curl -X POST "localhost:8080/v1/templates" -H "Content-Type: multipart/form-data" -F name=terraform -F template_content=@examples/terraform.template
$ curl -X POST "localhost:8080/v1/template_external_parameters" -H "Content-Type: application/json" -d '{"template_id": 1, "name": "dpid", "value": "dp-pica8"}'
$ # show generated template
$ curl -X GET "localhost:8080/v1/templates/1"
```

# API Server

Simple Rest API using gin(framework) & gorm(orm)

## Endpoint list

### Nodes Resource

```
GET    /<version>/nodes
GET    /<version>/nodes/:id
POST   /<version>/nodes
PUT    /<version>/nodes/:id
DELETE /<version>/nodes/:id
```

### NodeGroups Resource

```
GET    /<version>/node_groups
GET    /<version>/node_groups/:id
POST   /<version>/node_groups
PUT    /<version>/node_groups/:id
DELETE /<version>/node_groups/:id
```

### NodePvs Resource

```
GET    /<version>/node_pvs
GET    /<version>/node_pvs/:id
POST   /<version>/node_pvs
PUT    /<version>/node_pvs/:id
DELETE /<version>/node_pvs/:id
```

### NodeTypes Resource

```
GET    /<version>/node_types
GET    /<version>/node_types/:id
POST   /<version>/node_types
PUT    /<version>/node_types/:id
DELETE /<version>/node_types/:id
```

### Ports Resource

```
GET    /<version>/ports
GET    /<version>/ports/:id
POST   /<version>/ports
PUT    /<version>/ports/:id
DELETE /<version>/ports/:id
```

### Designs Resource

```
GET    /<version>/designs/present
PUT    /<version>/designs/present
DELETE /<version>/designs/present
```

### Segment Resource

```
GET    /<version>/segments
```

### Template Resource

```
GET    /<version>/templates
GET    /<version>/templates/:id
POST   /<version>/templates
PUT    /<version>/templates/:id
DELETE /<version>/templates/:id
PATCH /<version>/templates/:id
```

# Thanks

* Clay was partially generated by https://github.com/wantedly/apig
